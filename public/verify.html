router.get('/verify', async (req, res) => {
  const token = req.query.token;
  if (!token) return res.status(400).send('Invalid verification link.');

  const docRef = db.collection('submissions').doc(token);
  const doc = await docRef.get();

  if (!doc.exists) return res.status(404).send('Submission not found or already verified.');

  const data = doc.data();
  if (data.verified) {
    return res.send('✅ Already verified.');
  }

  await docRef.update({ verified: true });
  res.send('✅ Your submission has been verified. Thank you!');
});
